---
title: "Final_LearDistel"
author: "Lear Distel - 316495449"
date: "2024-03-24"
output:
  pdf_document: default
  html_document: default
---

**Chosen Data set: Evolution_DataSets.csv**

*Notice* this data set is mostly a character type so it was easier for me to explain using graph's.

this data-set includes the information about certain human species samples that used to live around the globe in ancient times and there body details and there habitats.

Libraries

```         
library(dplyr)
library(ggplot2)
library(gridExtra)
```

Read The Data

```         
Evo_data <- read.csv('Files/Evolution_DataSets.csv')
```

My main goal was to examine how different environmental factors encountered during the migration from Africa to Europe may have influenced the physical development of the human species.

The Questions:

-   what would be the average height of the species in each continent? and was it affected by there diet? or there location?

-   did they got taller throughout time? and was there any relation to migration?

-   what is the average overall ratio between there height and cranial capacity ?

-   which jaw shape they had comparing to there habitat and skeleton?

-   is there a strong connection between the jaw shape to the habitat?

[**Question 1:**]{.underline}

what would be the average height of the species in each continent? and was it affected by there diet? or there location?

at first ive mean the height of each continent so i could mark it on the upcoming plots.

```         
Height_mean <-  Evo_data |>
  group_by(Location) |>
  summarise(Mean_Height = mean(Height))
  print(Height_mean)
```

we can see that the Europa species are much taller, lets see if their Diet affects it.

ill create a plot for every continent and the print it all together.

```         
#Europa

plotEuropa <-Evo_data |> 
  filter(Location == 'Europa')|>
  ggplot(aes(x= Diet, y= Height)) +
  geom_boxplot() +
  geom_hline(yintercept = Height_mean$Mean_Height[3],linetype = 'dashed',color = 'red')+ggtitle('Europa')

# Africa

plotAfrica <- Evo_data |> 
  filter(Location == 'Africa')|>
  ggplot(aes(x= Diet, y= Height)) +
  geom_boxplot() +
  geom_hline(yintercept = Height_mean$Mean_Height[1],linetype = 'dashed',color = 'red')+ggtitle('Africa')

#Asia

plotAsia <- Evo_data |> 
  filter(Location == 'Asia ')|>
  ggplot(aes(x= Diet, y= Height)) +
  geom_boxplot() +
  geom_hline(yintercept = Height_mean$Mean_Height[2],linetype = 'dashed',color = 'red')+ggtitle('Asia')

grid_arrangement <- grid.arrange(plotAfrica,plotAsia,plotEuropa, nrow = 1)
```

![](FinalFiles/Rplot.png)

In Europa the average carnivorous weren't any taller but, they could be shorter than the average omnivore,in Africa we can see the carnivorous were much higher than the other diets only some of the omnivores reached the same height,in Asia there were only omnivores so comparing to the omnivores in the different continents we don't see any significant differences.

overall the data shows a potential connection between there height and diet without any direct connection to the continent.

[**Question 2:**]{.underline}

did they got taller throughout time? and was there any influence by migration?

i chose a loop to categorize each sample by the time they lived.

```         
zero_tothree <- c()
  three_tofive <- c()
  over_five <- c()
  
  for (i in 1:nrow(Evo_data)) { # <- Loop
    if (Evo_data$Time[i] > 0 & Evo_data$Time[i] < 3) {
      zero_tothree <- c(zero_tothree, Evo_data$Height[i])
      
    } else if(Evo_data$Time[i] > 3 & Evo_data$Time[i] < 5) {
      three_tofive <- c(three_tofive, Evo_data$Height[i])
      
    } else {
      over_five <- c(over_five, Evo_data$Height[i])
    }
  }
  
print(mean(zero_tothree))
print(mean(three_tofive))
print(mean(over_five))
```

and plotting :

```         
plot1 <- qplot(Evo_data$Time,Evo_data$Height, color = Evo_data$Location)+ ggtitle('Height/Location')

plot2 <- qplot(Evo_data$Time,Evo_data$Height, color = Evo_data$Migrated)+ ggtitle('Height/Migrated')

plot3 <- qplot(Evo_data$Time,Evo_data$Height, color = Evo_data$Current_Country)+ ggtitle('Height/currentCountry')

grid_arrangement <- grid.arrange(plot1,plot2,plot3, nrow = 2)
```

![](FinalFiles/Rplot01.png)

on the upper left ,Europa do shows significant signs for taller species, on the upper right we can see that between 2-4 on the x axis time line there was the beginning of migration according to the data-set.

and on the bottom left plot we can see the change in heights throughout time in African countries like south Africa and Kenya and the sudden appear of countries like Germany that shows taller species.

we can see that overall, species throughout time who migrated gone taller especially when they reached Europe which historically works with the common theory also species starts to migrate around 2-4(Time) and as time goes by we can see more European countries which appear on the graph.

[**Question 3:**]{.underline}

what is the average ratio between there height and cranial capacity and there bond?

```         
meanratio <- function(data1,data2){ 
  ratio <- data1/data2
  return(mean(ratio))
} 

meanratio(Evo_data$Height , Evo_data$Cranial_Capacity)

cor(Evo_data$Height , Evo_data$Cranial_Capacity)
```

well its quite clear that there is almost a 1/2 ratio between the height and the cranial capacity

and our correlation test suggests a strong bond between the two.

[**Question 4:**]{.underline}

Which jaw shape they had comparing to there habitat and skeleton?

```         
Africa_Evo <- Evo_data[Evo_data$Location == 'Africa',] 

plot4 <- Africa_Evo |> filter(Location == 'Africa')|>
  ggplot(aes(y= Time , x= Habitat, col = Jaw_Shape))+ geom_boxplot()+theme(axis.text.x = element_text(angle = 45))

plot5 <- Africa_Evo |> filter(Location == 'Africa')|>
  ggplot(aes(y= Time , x= Skeleton, col = Jaw_Shape))+ geom_boxplot()+theme(axis.text.x = element_text(angle = 45))

grid_arrangement <- grid.arrange(plot4,plot5, nrow = 1)
```

![](FinalFiles/Rplot02.png)

We can see a conical shape among the oldest species which use to habitat in mixed areas and the forest and throughout time we see the change as they coming out to the Savannah and other habitats and as you can see on the right a change in their skeleton too.

[**Question 5:**]{.underline}

is there a strong connection between the time and height?

lets check the correlation between them and run it 1000 times and than plot it

```         

MyCor <- cor(Evo_data$Time,Evo_data$Height)
print(MyCor)

Pi <- rep(NA , 1000)

for (i in 1:1000) {
  s1 <- sample(Evo_data$Height,replace = FALSE)
  Pi[i] <- cor(s1,Evo_data$Time)
  print(paste('finished itereation number' , i))
}
par(mfrow = c(1,1))
hist(Pi)
```

![](FinalFiles/Rplot03.png)

the test provides us with a very small p value which indicates that our result of -0.59475 in our correlation test is Correct and from that we can assume that our negative bond between the two variables suggests that the the "younger" the sample is, it will be taller.

**Conclusion:**

we could see some significant changes in the height of the samples while they were migrating to Europe throughout the years , also we could see there was some changes in the jaw shape and body throughout time which supports the changes we were looking for to see that the species sample's who we're migrating to Europe had some changes along the way.
